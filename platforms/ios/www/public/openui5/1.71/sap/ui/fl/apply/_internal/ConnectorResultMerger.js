/*
 * ! OpenUI5
 * (c) Copyright 2009-2019 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge"],function(m){"use strict";function f(r){var v={};r.some(function(R){if(R.variantSection&&Object.keys(R.variantSection).length>0){v=R.variantSection;return true;}});return v;}function c(){return{variantManagementChanges:{},variants:[]};}function a(v,V){var r=v[V];if(!r){r=C._createStandardVariant(V);v[V]=r;}return r;}function g(r){if(!r){return[];}return r.controlChanges.map(function(o){return o;});}function b(v,V){var o=m({},v);V.forEach(function(p){var s=p.variantReference;var r;if(s){r=a(o,s);}o[p.fileName]={content:p,controlChanges:g(r),variantChanges:{}};});return o;}function d(v,V){var o=m({},v);V.forEach(function(p){o[p.variantReference]=o[p.variantReference]||C._createStandardVariant(p.variantReference);o[p.variantReference].controlChanges.push(p);});return o;}function e(v,V){var o=m({},v);V.forEach(function(p){o[p.selector.id]=o[p.selector.id]||C._createStandardVariant(p.selector.id);var q=o[p.selector.id].variantChanges[p.changeType]||[];q.push(p);o[p.selector.id].variantChanges[p.changeType]=q;});return o;}function h(r,v){var R=m({},r);Object.keys(v).forEach(function(V){var o=v[V];var s=o.content.variantManagementReference;if(!R.variantSection[s]){R.variantSection[s]=c();}R.variantSection[s].variants.push(o);});return R;}function i(r,v){var R=m({},r);v.forEach(function(o){var V=o.selector.id;if(!R.variantSection[V]){R.variantSection[V]=c();}var s=o.changeType;if(!R.variantSection[V].variantManagementChanges[s]){R.variantSection[V].variantManagementChanges[s]=[];}R.variantSection[V].variantManagementChanges[s].push(o);});return R;}function j(r){var R=m({},r);Object.keys(R.variantSection).forEach(function(v){var V=R.variantSection[v];var s=V.variants.findIndex(function(o){return o.content.fileName===v;});var S;if(s===-1){S=C._createStandardVariant(v);}else{S=V.variants[s];V.variants.splice(s,1);}V.variants.unshift(S);});return R;}function k(r){var v=[];r.forEach(function(R){v=v.concat(R.variantManagementChanges);});return v;}function l(r){var v={};r.forEach(function(R){v=b(v,R.variants);v=d(v,R.variantDependentControlChanges);v=e(v,R.variantChanges);});return v;}function n(r,v,V){r=h(r,v);r=i(r,V);r=j(r);return r;}var C={};C._concatChanges=function(r){var o=[];r.forEach(function(R){o=o.concat(R.changes);});var p=[];o=o.filter(function(q){var F=q.fileName;var s=p.indexOf(F)!==-1;if(s){return false;}p.push(F);return true;});return o;};C.merge=function(p){var r={changes:C._concatChanges(p.responses),variantSection:{}};if(p.variantSectionSufficient){r.variantSection=f(p.responses);}else{var v=l(p.responses);var V=k(p.responses);r=n(r,v,V);}return r;};C._createStandardVariant=function(v){return{content:{fileName:v,variantManagementReference:v,content:{title:"STANDARD_VARIANT_TITLE"},favorite:true,visible:true},variantChanges:{},controlChanges:[]};};return C;});
